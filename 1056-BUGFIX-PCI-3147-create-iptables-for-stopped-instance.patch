From 5a463ce966b6a6e69b94741284aede612ab9a3a6 Mon Sep 17 00:00:00 2001
From: Tomas Dubec <tomas.dubec@gooddata.com>
Date: Tue, 14 Jan 2014 17:01:00 +0100
Subject: [PATCH] BUGFIX: PCI-3147 create iptables for stopped instances after
 host boot

---
 nova/compute/manager.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/nova/compute/manager.py b/nova/compute/manager.py
index 1c1ec85..ec7a97a 100644
--- a/nova/compute/manager.py
+++ b/nova/compute/manager.py
@@ -344,7 +344,7 @@ class ComputeManager(manager.SchedulerDependentManager):
                         self._set_instance_error_state(context,
                                                        instance['uuid'])

-                elif drv_state == power_state.RUNNING:
+                elif drv_state in (power_state.RUNNING, power_state.SHUTDOWN):
                     # VMWareAPI drivers will raise an exception
                     try:
                         self.driver.ensure_filtering_rules_for_instance(
--
1.8.5.2

