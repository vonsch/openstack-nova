--- nova-2012.1/nova/virt/libvirt/volume.py.orig	2012-05-31 14:57:20.680836101 +0200
+++ nova-2012.1/nova/virt/libvirt/volume.py	2012-05-31 16:02:04.590757676 +0200
@@ -18,6 +18,7 @@
 """Volume drivers for libvirt."""
 
 import os
+from os.path import  basename
 import time
 
 from nova import exception
@@ -47,7 +48,7 @@
                      <driver name='%s' type='raw' cache='none'/>
                      <source dev='%s'/>
                      <target dev='%s' bus='virtio'/>
-                 </disk>""" % (driver, device_path, mount_device)
+                 </disk>""" % (driver, device_path, basename(mount_device))
         return xml
 
     def disconnect_volume(self, connection_info, mount_device):
@@ -65,7 +66,7 @@
                      <driver name='qemu' type='raw' cache='none'/>
                      <source protocol='%s' name='%s'/>
                      <target dev='%s' bus='virtio'/>
-                 </disk>""" % (protocol, name, mount_device)
+                 </disk>""" % (protocol, name, basename(mount_device))
         return xml
 
 
@@ -88,13 +89,13 @@
                          </auth>
                          <target dev='%s' bus='virtio'/>
                      </disk>""" % (driver, protocol, name, username,
-                                   secret_type, secret_uuid, mount_device)
+                                   secret_type, secret_uuid, basename(mount_device))
         else:
             xml = """<disk type='network'>
                          <driver name='%s' type='raw' cache='none'/>
                          <source protocol='%s' name='%s'/>
                          <target dev='%s' bus='virtio'/>
-                     </disk>""" % (driver, protocol, name, mount_device)
+                     </disk>""" % (driver, protocol, name, basename(mount_device))
         return xml
